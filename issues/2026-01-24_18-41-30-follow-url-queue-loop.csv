id,priority,phase,area,title,description,acceptance_criteria,test_mcp,review_initial_requirements,review_regression_requirements,dev_state,review_initial_state,review_regression_state,git_state,owner,refs,notes
"FQ-010","P0","1","backend","扩展 bulk 配置：URL 队列/间隔/冷却","在 bulk_config 增加 followUrls 与节奏参数，作为队列任务的唯一持久化配置。","/api/bulk/config 保存后可读回：followUrls、followActionDelaySec、followCooldownEvery、followCooldownSec、followIdleSleepSec 均被持久化；缺失/非法值会被 normalize 到合法范围；不影响既有 accounts/captions/imageDir。","AUTOSERVER","保持向后兼容：旧 bulk_config.json 不含新字段也不崩；normalize 有上下限，默认值避免热循环。","回归批量发帖/图库扫描/账号管理：保存配置、扫描图库、启动/停止批量发帖均正常。","已完成","已完成","已完成","已提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:18;server.js:4857;server.js:4877","picked_reason:先落配置schema/normalize，后续API与引擎依赖; done_at:2026-01-24; evidence:node临时脚本验证 bulk_config normalize + bulk endpoints"
"FQ-020","P0","2","backend","URL 队列 API：追加/状态/启动兼容","新增追加 URL API，并扩展关注任务 status/start 以支持队列模式与运行中追加。","POST /api/bulk/follow-urls/add 支持数组或多行文本输入，去重+normalize；非法 URL 返回 400 并说明；GET /api/bulk/follow-commenters/status 返回 queue 元信息；POST /api/bulk/follow-commenters/start 在队列非空时可无 tweetUrl 直接启动，传 tweetUrl 等价于“追加+启动”。","AUTOSERVER","接口幂等与并发安全：运行中追加不会打断 worker；错误信息清晰；队列更新持久化。","回归：旧 UI 仍可仅传 tweetUrl 启动单次任务；start/stop/status 旧字段不丢失。","已完成","已完成","已完成","已提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:19;server.js:4999;server.js:5038","picked_reason:提供运行中追加URL的最小闭环接口; done_at:2026-01-24; evidence:node临时脚本验证 follow-urls/add 400&ok + status.queue + start无tweetUrl走队列"
"FQ-030","P0","3","backend","执行引擎：按账号并行跑 URL 队列并循环","把单 URL 任务升级为 URL 队列循环任务：每账号 worker，按并行数执行，队列末尾回到开头，支持 stop。","启动后并行数遵循 followConcurrency（含 jitter）；每个参与账号按 followUrls 顺序处理并在末尾回到开头持续运行，直到 stop；stop 在扫描/关注/等待/冷却阶段均可在 5 秒内生效。","AUTOE2E","资源与健壮性：浏览器实例数可控；异常不会导致全局任务僵死；sleep 可被 stop 打断。","回归：不同账号 Profile 不串；既有关注评论单 URL 功能在队列=1 时行为一致。","已完成","已完成","已完成","已提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:23;server.js:2478;server.js:3389","picked_reason:实现队列循环/并发是核心能力，后续切换与UI依赖; done_at:2026-01-24; evidence:node临时脚本验证 queue模式 start/stop<5s(无profile) + sleep可打断; validation_limited:未在真实已登录Profile下跑实际关注; manual_test:准备>=1个已登录profile账号+>=2条status URL, bulk页启动(不填tweetUrl)观察轮转与停止; risk:medium 导航/网络等待可能仍>5s"
"FQ-040","P0","4","backend","URL 完成条件与切换/idle 策略","定义每条 URL 的完成条件并切换到下一条；队列空或无新增时进入 idle，避免热循环。","对单 URL：达到 maxPerAccount 或无新增评论用户或日上限耗尽会切换到下一条且日志可见；followUrls 为空时进入 idle（>=followIdleSleepSec）且不会高频刷日志/滚动；日上限耗尽的账号按既定策略等待到次日或跳过并记录。","AUTOE2E","切换逻辑不漏/不错切；idle 不 busy loop；日上限使用本地日期 key（localDateKey）一致。","回归：队列只有 1 条 URL 时仍稳定循环且 CPU/日志不异常增长。","已完成","已完成","已完成","已提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:26;server.js:2699;server.js:2789;server.js:2821;server.js:1762","picked_reason:补齐切换与idle/日上限策略，避免热循环; done_at:2026-01-24; evidence:node --check server.js; validation_limited:未在真实已登录Profile下验证轮转/idle/日上限等待; manual_test:准备>=1个已登录profile账号，followUrls置空点击开始观察idle>=followIdleSleepSec且日志不刷屏；再追加2条URL观察切换与stop; risk:medium"
"FQ-050","P1","5","backend","状态与日志：暴露当前账号/URL/冷却剩余","扩展 bulkFollowJob/status 输出，便于 UI 展示队列与冷却进度，并补齐关键日志点。","GET /api/bulk/follow-commenters/status 可看到 currentAccount/currentUrl/urlsTotal 等字段；切换 URL、进入冷却、队列变更都有清晰日志；异常情况下 job 状态仍可查询。","AUTOSERVER","字段命名稳定；proxy 等敏感字段继续脱敏；状态更新不会与并发 worker 打架。","回归：/api/bulk/status、/api/bulk/logs 与现有批量发帖调度不受影响。","未开始","未开始","未开始","未提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:29;server.js:1016;server.js:5038",""
"FQ-060","P0","6","frontend","UI：多 URL 队列 + 关注间隔/冷却输入","在 bulk 面板增加多行 URL 输入与追加按钮，并新增关注间隔与冷却配置输入，完成保存/渲染与启动联动。","bulk.html 出现多行 URL 输入框与“追加到队列”；可看到队列摘要（总数/当前 URL）；新增输入：followActionDelaySec、followCooldownEvery、followCooldownSec（保存后刷新仍保留）；点击开始后任务按队列运行并能在 UI 看到状态更新。","AUTOE2E","交互不阻塞：追加成功有提示；非法 URL 有提示；控件布局对齐、移动端不溢出。","回归：账号管理/图库/文案/批量发帖 UI 均正常；旧的关注评论启动流程仍可用。","未开始","未开始","未开始","未提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:30;public/bulk.html:195;public/bulk.js:62",""
"FQ-070","P1","7","backend","兼容迁移：tweetUrl → followUrls","兼容旧调用方式与历史配置：当存在 tweetUrl（接口参数或旧字段）时自动写入 followUrls，避免用户升级后失效。","POST /api/bulk/follow-commenters/start 仅传 tweetUrl 仍能正常启动；若 followUrls 为空会自动把 tweetUrl 追加进队列并持久化；旧 bulk_config.json 不含 followUrls 也不会导致启动报错。","AUTOSERVER","迁移过程幂等（重复启动不会不断追加重复 URL）；去重与 normalize 一致。","回归：现有 start/stop/status 的字段结构保持兼容；升级前后的 bulk_config.json 都能被读取。","未开始","未开始","未开始","未提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:33;server.js:4999;server.js:4857",""
"FQ-080","P0","8","both","验收与回归清单（含边界场景）","按计划执行手工与边界回归，确保运行中追加、轮转、间隔、冷却、stop、空队列 idle、日上限全链路可用。","至少 2 账号 + 2 URL：观察账号按 URL 轮转；运行中追加新 URL 后能被后续轮次处理；关注间隔与冷却严格生效；stop 在冷却/idle 也能立即停止；空队列启动进入 idle；重复/非法 URL 能提示。","AUTOE2E","过程中记录关键日志与 status 输出（用于 review）；确认无热循环/资源泄漏（浏览器能退出）。","完成后复跑一次现有核心脚本（npm run core-test / npm run smoke）确保无破坏（若依赖 key 则按说明配置）。","未开始","未开始","未开始","未提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:34;scripts/core-test.mjs:1;scripts/smoke-test.mjs:1",""
"FQ-090","P1","9","both","文档与发布：更新 README/CHANGELOG 并打包发布","补齐使用说明与变更记录，完成打包验证并通过 tag 触发 Release。","README.md 补充队列模式使用方法与参数说明；CHANGELOG.md 记录版本；本地 npm run release:exe 成功且 UI 可见；push main + tag 后 GitHub Release 产物生成（win/macos）。","AUTOE2E","文档描述与 UI 字段一致；默认值与上限写清楚；避免硬编码本机路径。","回归：下载 release 压缩包在干净目录解压运行，队列 UI 可见，基础面板可打开。","未开始","未开始","未开始","未提交","","plan/2026-01-24_17-41-05-follow-url-queue-loop.md:37;README.md:1;CHANGELOG.md:1",""
